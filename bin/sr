#!/usr/bin/env ruby

# scholar-rename, interactive pdf-namer
# prereq: pdftotext installation for text dump
# renames a pdf file to author-title-year.pdf
# or other formats based on your selection
# todo - make a suite of decent tests
# by jeremy warner, fall 2016

require "selector"
file = ARGV.first
temp = "temp-scholar-rename-text"
system("pdftotext -q #{file} #{temp}")
content = File.read temp

# Choose pdf qualities
s = Selector.new(content)
s.select # choose props
printf "#{s.title} - ok? [yN]: "
conf = STDIN.gets.chomp # confirm title
begin # file read in from first ARGV above
  File.rename(file, s.title) if conf.match /^(y|Y).*/
ensure # cleaning up file cleanup from pdftotext
  puts "Cleaning up..."
  File.delete(temp)
end

